#' Validates If Valid CIP Code
#'
#' Validates If Valid CIP Code
#'
#' @param data A data frame.
#' @param x Column name from \code{data} (character string).
#' @param \dots ignored.
#' @export
#' @return Returns a \code{vc} classed list object.
#' @examples
#' dat <- data.frame(
#'     cips = c('9.99.99', '22', '22.', '22.34', '22.234', '22.2344', '22.2345', NA),
#'     stringsAsFactors = FALSE
#' )
#' vc_cipcode(dat, 'cips')
vc_cipcode <- function(data, x, ...){

    ## select the column & replace missing with NA
    col <- sub_out_missing(data[[x]])

    ## record missing (NA)
    is_na <- is.na(col)

    ## expression to validate against (elementwise)

    #    ##removed regex validation below to be specific 11/02/2016
    #    #cipregex <- "(^0$)(*SKIP)(*FAIL)|((^\\s*\\d{1,2}\\.??\\s*$)|(^\\s*\\d{1,2}\\.(\\d{2,4})\\s*$))"
    #    #is_valid <- grepl(cipregex, col, perl=TRUE)
# browser()
    is_valid <- col %in% valid_cips_all
    is_valid[is_na] <- NA

    ## valid columnwise: Are all elelemnts either valid or NA?
    are_valid <- all(is_valid|is_na)

    ## generate the comment
    if (!are_valid){
        message <- sprintf(
	      "The following rows of %s do not match a 2010 CIP Code:\n\n%s\n\n\n\n",
		sQuote(x),
		output_truncate(which(!(is_valid|is_na)))
        )
    } else {
        message <- NULL
    }

    ## construct vc list & class
    vc_output <- list(
        column_name = x,
        valid = are_valid,
        message = message,
        passing = is_valid,
        missing = is_na,
        call = 'vc_cipcode'
    )

    class(vc_output) <- 'vc'
    vc_output
}

##--------Making Cip Codes-----------------------------
## to make cip code possibilities

### read in cips (cips data in Azure data lake)
# valid_cips <- CIP_CODE_VALUES HERE

### Make sure has period in 1-2 digit cips
# valid_cips <- gsub('^(\\d{1,2})$', "\\1.", cips)

### make vector with period cips and no period cips
#valid_cips <- unique(c(cips, gsub("\\.", "", cips)))

### add removed leading zeros cips to vector
#valid_cips <- unique(c(cips, gsub("^0+", "", cips)))
##--------End: Making Cip Codes-----------------------------



valid_cips <- c("1", "1.01", "1.0101", "1.0102", "1.0103", "1.0104", "1.0105",
    "1.0106", "1.0199", "1.02", "1.0201", "1.0204", "1.0205", "1.0299",
    "1.03", "1.0301", "1.0302", "1.0303", "1.0304", "1.0306", "1.0307",
    "1.0308", "1.0309", "1.0399", "1.04", "1.0401", "1.05", "1.0504",
    "1.0505", "1.0507", "1.0508", "1.0599", "1.06", "1.0601", "1.0603",
    "1.0604", "1.0605", "1.0606", "1.0607", "1.0608", "1.0699", "1.07",
    "1.0701", "1.08", "1.0801", "1.0802", "1.0899", "1.09", "1.0901",
    "1.0902", "1.0903", "1.0904", "1.0905", "1.0906", "1.0907", "1.0999",
    "1.1", "1.1001", "1.1002", "1.1099", "1.11", "1.1101", "1.1102",
    "1.1103", "1.1104", "1.1105", "1.1106", "1.1199", "1.12", "1.1201",
    "1.1202", "1.1203", "1.1299", "1.99", "1.9999", "10", "10.01",
    "10.0105", "10.02", "10.0201", "10.0202", "10.0203", "10.0299",
    "10.03", "10.0301", "10.0302", "10.0303", "10.0304", "10.0305",
    "10.0306", "10.0307", "10.0308", "10.0399", "10.99", "10.9999",
    "11", "11.01", "11.0101", "11.0102", "11.0103", "11.0104", "11.0199",
    "11.02", "11.0201", "11.0202", "11.0203", "11.0299", "11.03",
    "11.0301", "11.04", "11.0401", "11.05", "11.0501", "11.06", "11.0601",
    "11.0602", "11.0699", "11.07", "11.0701", "11.08", "11.0801",
    "11.0802", "11.0803", "11.0804", "11.0899", "11.09", "11.0901",
    "11.1", "11.1001", "11.1002", "11.1003", "11.1004", "11.1005",
    "11.1006", "11.1099", "11.99", "11.9999", "12", "12.03", "12.0301",
    "12.0302", "12.0303", "12.0399", "12.04", "12.0401", "12.0402",
    "12.0404", "12.0406", "12.0407", "12.0408", "12.0409", "12.041",
    "12.0411", "12.0412", "12.0413", "12.0414", "12.0499", "12.05",
    "12.0501", "12.0502", "12.0503", "12.0504", "12.0505", "12.0506",
    "12.0507", "12.0508", "12.0509", "12.051", "12.0599", "12.99",
    "12.9999", "13", "13.01", "13.0101", "13.02", "13.0201", "13.0202",
    "13.0203", "13.0299", "13.03", "13.0301", "13.04", "13.0401",
    "13.0402", "13.0403", "13.0404", "13.0406", "13.0407", "13.0408",
    "13.0409", "13.041", "13.0411", "13.0499", "13.05", "13.0501",
    "13.06", "13.0601", "13.0603", "13.0604", "13.0607", "13.0699",
    "13.07", "13.0701", "13.09", "13.0901", "13.1", "13.1001", "13.1003",
    "13.1004", "13.1005", "13.1006", "13.1007", "13.1008", "13.1009",
    "13.1011", "13.1012", "13.1013", "13.1014", "13.1015", "13.1016",
    "13.1017", "13.1018", "13.1019", "13.1099", "13.11", "13.1101",
    "13.1102", "13.1199", "13.12", "13.1201", "13.1202", "13.1203",
    "13.1205", "13.1206", "13.1207", "13.1208", "13.1209", "13.121",
    "13.1299", "13.13", "13.1301", "13.1302", "13.1303", "13.1304",
    "13.1305", "13.1306", "13.1307", "13.1308", "13.1309", "13.131",
    "13.1311", "13.1312", "13.1314", "13.1315", "13.1316", "13.1317",
    "13.1318", "13.1319", "13.132", "13.1321", "13.1322", "13.1323",
    "13.1324", "13.1325", "13.1326", "13.1327", "13.1328", "13.1329",
    "13.133", "13.1331", "13.1332", "13.1333", "13.1334", "13.1335",
    "13.1337", "13.1338", "13.1399", "13.14", "13.1401", "13.1402",
    "13.1499", "13.15", "13.1501", "13.1502", "13.1599", "13.99",
    "13.9999", "14", "14.01", "14.0101", "14.0102", "14.02", "14.0201",
    "14.03", "14.0301", "14.04", "14.0401", "14.05", "14.0501", "14.06",
    "14.0601", "14.07", "14.0701", "14.0702", "14.0799", "14.08",
    "14.0801", "14.0802", "14.0803", "14.0804", "14.0805", "14.0899",
    "14.09", "14.0901", "14.0902", "14.0903", "14.0999", "14.1",
    "14.1001", "14.1003", "14.1004", "14.1099", "14.11", "14.1101",
    "14.12", "14.1201", "14.13", "14.1301", "14.14", "14.1401", "14.18",
    "14.1801", "14.19", "14.1901", "14.2", "14.2001", "14.21", "14.2101",
    "14.22", "14.2201", "14.23", "14.2301", "14.24", "14.2401", "14.25",
    "14.2501", "14.27", "14.2701", "14.28", "14.2801", "14.31", "14.3101",
    "14.32", "14.3201", "14.33", "14.3301", "14.34", "14.3401", "14.35",
    "14.3501", "14.36", "14.3601", "14.37", "14.3701", "14.38", "14.3801",
    "14.39", "14.3901", "14.4", "14.4001", "14.41", "14.4101", "14.42",
    "14.4201", "14.43", "14.4301", "14.44", "14.4401", "14.45", "14.4501",
    "14.99", "14.9999", "15", "15.01", "15.0101", "15.02", "15.0201",
    "15.03", "15.0303", "15.0304", "15.0305", "15.0306", "15.0399",
    "15.04", "15.0401", "15.0403", "15.0404", "15.0405", "15.0406",
    "15.0499", "15.05", "15.0501", "15.0503", "15.0505", "15.0506",
    "15.0507", "15.0508", "15.0599", "15.06", "15.0607", "15.0611",
    "15.0612", "15.0613", "15.0614", "15.0615", "15.0616", "15.0699",
    "15.07", "15.0701", "15.0702", "15.0703", "15.0704", "15.0799",
    "15.08", "15.0801", "15.0803", "15.0805", "15.0899", "15.09",
    "15.0901", "15.0903", "15.0999", "15.1", "15.1001", "15.11",
    "15.1102", "15.1103", "15.1199", "15.12", "15.1201", "15.1202",
    "15.1203", "15.1204", "15.1299", "15.13", "15.1301", "15.1302",
    "15.1303", "15.1304", "15.1305", "15.1306", "15.1399", "15.14",
    "15.1401", "15.15", "15.1501", "15.1502", "15.1503", "15.1599",
    "15.16", "15.1601", "15.99", "15.9999", "16", "16.01", "16.0101",
    "16.0102", "16.0103", "16.0104", "16.0105", "16.0199", "16.02",
    "16.0201", "16.03", "16.0301", "16.0302", "16.0303", "16.0304",
    "16.0399", "16.04", "16.0401", "16.0402", "16.0404", "16.0405",
    "16.0406", "16.0407", "16.0408", "16.0409", "16.041", "16.0499",
    "16.05", "16.0501", "16.0502", "16.0503", "16.0504", "16.0505",
    "16.0506", "16.0599", "16.06", "16.0601", "16.07", "16.0701",
    "16.0702", "16.0704", "16.0705", "16.0706", "16.0707", "16.0799",
    "16.08", "16.0801", "16.09", "16.0901", "16.0902", "16.0904",
    "16.0905", "16.0906", "16.0907", "16.0908", "16.0999", "16.1",
    "16.1001", "16.11", "16.1101", "16.1102", "16.1103", "16.1199",
    "16.12", "16.1202", "16.1203", "16.1299", "16.13", "16.1301",
    "16.14", "16.1401", "16.1402", "16.1403", "16.1404", "16.1405",
    "16.1406", "16.1407", "16.1408", "16.1499", "16.15", "16.1501",
    "16.1502", "16.1503", "16.1504", "16.1599", "16.16", "16.1601",
    "16.1602", "16.1603", "16.1699", "16.99", "16.9999", "19", "19.01",
    "19.0101", "19.02", "19.0201", "19.0202", "19.0203", "19.0299",
    "19.04", "19.0401", "19.0402", "19.0403", "19.0499", "19.05",
    "19.0501", "19.0504", "19.0505", "19.0599", "19.06", "19.0601",
    "19.0604", "19.0605", "19.0699", "19.07", "19.0701", "19.0702",
    "19.0704", "19.0706", "19.0707", "19.0708", "19.0709", "19.071",
    "19.0799", "19.09", "19.0901", "19.0902", "19.0904", "19.0905",
    "19.0906", "19.0999", "19.99", "19.9999", "21", "21.01", "21.0101",
    "22", "22.0001", "22.01", "22.0101", "22.02", "22.0201", "22.0202",
    "22.0203", "22.0204", "22.0205", "22.0206", "22.0207", "22.0208",
    "22.0209", "22.021", "22.0211", "22.0212", "22.0299", "22.03",
    "22.0301", "22.0302", "22.0303", "22.0399", "22.99", "22.9999",
    "23", "23.01", "23.0101", "23.04", "23.0401", "23.05", "23.0501",
    "23.07", "23.0701", "23.0702", "23.08", "23.0801", "23.1", "23.1001",
    "23.11", "23.1101", "23.13", "23.1301", "23.1302", "23.1303",
    "23.1304", "23.1399", "23.14", "23.1401", "23.1402", "23.1403",
    "23.1404", "23.1405", "23.1499", "23.99", "23.9999", "24", "24.01",
    "24.0101", "24.0102", "24.0103", "24.0199", "25", "25.01", "25.0101",
    "25.0102", "25.0103", "25.0199", "25.03", "25.0301", "25.99",
    "25.9999", "26", "26.01", "26.0101", "26.0102", "26.02", "26.0202",
    "26.0203", "26.0204", "26.0205", "26.0206", "26.0207", "26.0208",
    "26.0209", "26.021", "26.0299", "26.03", "26.0301", "26.0305",
    "26.0307", "26.0308", "26.0399", "26.04", "26.0401", "26.0403",
    "26.0404", "26.0405", "26.0406", "26.0407", "26.0499", "26.05",
    "26.0502", "26.0503", "26.0504", "26.0505", "26.0506", "26.0507",
    "26.0508", "26.0599", "26.07", "26.0701", "26.0702", "26.0707",
    "26.0708", "26.0709", "26.0799", "26.08", "26.0801", "26.0802",
    "26.0803", "26.0804", "26.0805", "26.0806", "26.0807", "26.0899",
    "26.09", "26.0901", "26.0902", "26.0903", "26.0904", "26.0905",
    "26.0906", "26.0907", "26.0908", "26.0909", "26.091", "26.0911",
    "26.0912", "26.0999", "26.1", "26.1001", "26.1002", "26.1003",
    "26.1004", "26.1005", "26.1006", "26.1007", "26.1099", "26.11",
    "26.1101", "26.1102", "26.1103", "26.1104", "26.1199", "26.12",
    "26.1201", "26.13", "26.1301", "26.1302", "26.1303", "26.1304",
    "26.1305", "26.1306", "26.1307", "26.1308", "26.1309", "26.131",
    "26.1399", "26.14", "26.1401", "26.15", "26.1501", "26.1502",
    "26.1503", "26.1504", "26.1599", "26.99", "26.9999", "27", "27.01",
    "27.0101", "27.0102", "27.0103", "27.0104", "27.0105", "27.0199",
    "27.03", "27.0301", "27.0303", "27.0304", "27.0305", "27.0306",
    "27.0399", "27.05", "27.0501", "27.0502", "27.0503", "27.0599",
    "27.99", "27.9999", "28", "28.01", "28.0101", "28.0199", "28.03",
    "28.0301", "28.0399", "28.04", "28.0401", "28.0499", "28.05",
    "28.0501", "28.0502", "28.0503", "28.0504", "28.0505", "28.0506",
    "28.0599", "28.06", "28.0601", "28.0602", "28.0603", "28.0604",
    "28.0605", "28.0699", "28.07", "28.0701", "28.0702", "28.0703",
    "28.0799", "28.99", "28.9999", "29", "29.01", "29.0101", "29.02",
    "29.0201", "29.0202", "29.0203", "29.0204", "29.0205", "29.0206",
    "29.0207", "29.0299", "29.03", "29.0301", "29.0302", "29.0303",
    "29.0304", "29.0305", "29.0306", "29.0307", "29.0399", "29.04",
    "29.0401", "29.0402", "29.0403", "29.0404", "29.0405", "29.0406",
    "29.0407", "29.0408", "29.0409", "29.0499", "29.99", "29.9999",
    "3", "3.01", "3.0101", "3.0103", "3.0104", "3.0199", "3.02",
    "3.0201", "3.0204", "3.0205", "3.0206", "3.0207", "3.0208", "3.0299",
    "3.03", "3.0301", "3.05", "3.0501", "3.0502", "3.0506", "3.0508",
    "3.0509", "3.051", "3.0511", "3.0599", "3.06", "3.0601", "3.99",
    "3.9999", "30", "30.01", "30.0101", "30.05", "30.0501", "30.06",
    "30.0601", "30.08", "30.0801", "30.1", "30.1001", "30.11", "30.1101",
    "30.12", "30.1201", "30.1202", "30.1299", "30.13", "30.1301",
    "30.14", "30.1401", "30.15", "30.1501", "30.16", "30.1601", "30.17",
    "30.1701", "30.18", "30.1801", "30.19", "30.1901", "30.2", "30.2001",
    "30.21", "30.2101", "30.22", "30.2201", "30.2202", "30.23", "30.2301",
    "30.24", "30.2401", "30.25", "30.2501", "30.26", "30.2601", "30.27",
    "30.2701", "30.28", "30.2801", "30.29", "30.2901", "30.3", "30.3001",
    "30.31", "30.3101", "30.32", "30.3201", "30.33", "30.3301", "30.99",
    "30.9999", "31", "31.01", "31.0101", "31.03", "31.0301", "31.0302",
    "31.0399", "31.05", "31.0501", "31.0504", "31.0505", "31.0507",
    "31.0508", "31.0599", "31.06", "31.0601", "31.99", "31.9999",
    "32", "32.01", "32.0101", "32.0104", "32.0105", "32.0107", "32.0108",
    "32.0109", "32.011", "32.0111", "32.0199", "33", "33.01", "33.0101",
    "33.0102", "33.0103", "33.0104", "33.0105", "33.0199", "34",
    "34.01", "34.0102", "34.0103", "34.0104", "34.0199", "35", "35.01",
    "35.0101", "35.0102", "35.0103", "35.0199", "36", "36.01", "36.0101",
    "36.0102", "36.0103", "36.0105", "36.0106", "36.0107", "36.0108",
    "36.0109", "36.011", "36.0111", "36.0112", "36.0113", "36.0114",
    "36.0115", "36.0116", "36.0117", "36.0118", "36.0119", "36.0199",
    "37", "37.01", "37.0101", "37.0102", "37.0103", "37.0104", "37.0199",
    "38", "38.0001", "38.01", "38.0101", "38.0102", "38.0103", "38.0104",
    "38.0199", "38.02", "38.0201", "38.0202", "38.0203", "38.0204",
    "38.0205", "38.0206", "38.0299", "38.99", "38.9999", "39", "39.02",
    "39.0201", "39.03", "39.0301", "39.04", "39.0401", "39.05", "39.0501",
    "39.06", "39.0601", "39.0602", "39.0604", "39.0605", "39.0606",
    "39.0699", "39.07", "39.0701", "39.0702", "39.0703", "39.0704",
    "39.0705", "39.0799", "39.99", "39.9999", "4", "4.02", "4.0201",
    "4.03", "4.0301", "4.04", "4.0401", "4.05", "4.0501", "4.06",
    "4.0601", "4.08", "4.0801", "4.09", "4.0901", "4.0902", "4.0999",
    "4.1", "4.1001", "4.99", "4.9999", "40", "40.01", "40.0101",
    "40.02", "40.0201", "40.0202", "40.0203", "40.0299", "40.04",
    "40.0401", "40.0402", "40.0403", "40.0404", "40.0499", "40.05",
    "40.0501", "40.0502", "40.0503", "40.0504", "40.0506", "40.0507",
    "40.0508", "40.0509", "40.051", "40.0511", "40.0599", "40.06",
    "40.0601", "40.0602", "40.0603", "40.0604", "40.0605", "40.0606",
    "40.0607", "40.0699", "40.08", "40.0801", "40.0802", "40.0804",
    "40.0805", "40.0806", "40.0807", "40.0808", "40.0809", "40.081",
    "40.0899", "40.1", "40.1001", "40.1002", "40.1099", "40.99",
    "40.9999", "41", "41.01", "41.0101", "41.02", "41.0204", "41.0205",
    "41.0299", "41.03", "41.0301", "41.0303", "41.0399", "41.99",
    "41.9999", "42", "42.01", "42.0101", "42.02", "42.0201", "42.03",
    "42.0301", "42.04", "42.0401", "42.05", "42.0501", "42.06", "42.0601",
    "42.07", "42.0701", "42.08", "42.0801", "42.09", "42.0901", "42.1",
    "42.1001", "42.11", "42.1101", "42.16", "42.1601", "42.17", "42.1701",
    "42.18", "42.1801", "42.19", "42.1901", "42.2", "42.2001", "42.21",
    "42.2101", "42.22", "42.2201", "42.23", "42.2301", "42.24", "42.2401",
    "42.25", "42.2501", "42.26", "42.2601", "42.27", "42.2701", "42.2702",
    "42.2703", "42.2704", "42.2705", "42.2706", "42.2707", "42.2708",
    "42.2709", "42.2799", "42.28", "42.2801", "42.2802", "42.2803",
    "42.2804", "42.2805", "42.2806", "42.2807", "42.2808", "42.2809",
    "42.281", "42.2811", "42.2812", "42.2813", "42.2814", "42.2899",
    "42.99", "42.9999", "43", "43.01", "43.0102", "43.0103", "43.0104",
    "43.0106", "43.0107", "43.0109", "43.011", "43.0111", "43.0112",
    "43.0113", "43.0114", "43.0115", "43.0116", "43.0117", "43.0118",
    "43.0119", "43.012", "43.0121", "43.0122", "43.0123", "43.0199",
    "43.02", "43.0201", "43.0202", "43.0203", "43.0204", "43.0205",
    "43.0206", "43.0299", "43.03", "43.0301", "43.0302", "43.0303",
    "43.0304", "43.0399", "43.99", "43.9999", "44", "44.02", "44.0201",
    "44.04", "44.0401", "44.05", "44.0501", "44.0502", "44.0503",
    "44.0504", "44.0599", "44.07", "44.0701", "44.0702", "44.0799",
    "44.99", "44.9999", "45", "45.01", "45.0101", "45.0102", "45.02",
    "45.0201", "45.0202", "45.0203", "45.0204", "45.0299", "45.03",
    "45.0301", "45.04", "45.0401", "45.05", "45.0501", "45.06", "45.0601",
    "45.0602", "45.0603", "45.0604", "45.0605", "45.0699", "45.07",
    "45.0701", "45.0702", "45.0799", "45.09", "45.0901", "45.0902",
    "45.0999", "45.1", "45.1001", "45.1002", "45.1003", "45.1004",
    "45.1099", "45.11", "45.1101", "45.12", "45.1201", "45.13", "45.1301",
    "45.14", "45.1401", "45.99", "45.9999", "46", "46.01", "46.0101",
    "46.02", "46.0201", "46.03", "46.0301", "46.0302", "46.0303",
    "46.0399", "46.04", "46.0401", "46.0402", "46.0403", "46.0404",
    "46.0406", "46.0408", "46.041", "46.0411", "46.0412", "46.0413",
    "46.0414", "46.0415", "46.0499", "46.05", "46.0502", "46.0503",
    "46.0504", "46.0505", "46.0599", "46.99", "46.9999", "47", "47.01",
    "47.0101", "47.0102", "47.0103", "47.0104", "47.0105", "47.0106",
    "47.011", "47.0199", "47.02", "47.0201", "47.03", "47.0302",
    "47.0303", "47.0399", "47.04", "47.0402", "47.0403", "47.0404",
    "47.0408", "47.0409", "47.0499", "47.06", "47.0603", "47.0604",
    "47.0605", "47.0606", "47.0607", "47.0608", "47.0609", "47.061",
    "47.0611", "47.0612", "47.0613", "47.0614", "47.0615", "47.0616",
    "47.0617", "47.0618", "47.0699", "47.99", "47.9999", "48", "48.03",
    "48.0303", "48.0304", "48.0399", "48.05", "48.0501", "48.0503",
    "48.0506", "48.0507", "48.0508", "48.0509", "48.051", "48.0511",
    "48.0599", "48.07", "48.0701", "48.0702", "48.0703", "48.0799",
    "48.08", "48.0801", "48.99", "48.9999", "49", "49.01", "49.0101",
    "49.0102", "49.0104", "49.0105", "49.0106", "49.0108", "49.0199",
    "49.02", "49.0202", "49.0205", "49.0206", "49.0207", "49.0208",
    "49.0299", "49.03", "49.0303", "49.0304", "49.0309", "49.0399",
    "49.99", "49.9999", "5", "5.01", "5.0101", "5.0102", "5.0103",
    "5.0104", "5.0105", "5.0106", "5.0107", "5.0108", "5.0109", "5.011",
    "5.0111", "5.0112", "5.0113", "5.0114", "5.0115", "5.0116", "5.0117",
    "5.0118", "5.0119", "5.012", "5.0121", "5.0122", "5.0123", "5.0124",
    "5.0125", "5.0126", "5.0127", "5.0128", "5.0129", "5.013", "5.0131",
    "5.0132", "5.0133", "5.0134", "5.0199", "5.02", "5.0201", "5.0202",
    "5.0203", "5.0206", "5.0207", "5.0208", "5.0209", "5.021", "5.0211",
    "5.0299", "5.99", "5.9999", "50", "50.01", "50.0101", "50.0102",
    "50.02", "50.0201", "50.03", "50.0301", "50.0302", "50.0399",
    "50.04", "50.0401", "50.0402", "50.0404", "50.0406", "50.0407",
    "50.0408", "50.0409", "50.041", "50.0411", "50.0499", "50.05",
    "50.0501", "50.0502", "50.0504", "50.0505", "50.0506", "50.0507",
    "50.0508", "50.0509", "50.051", "50.0599", "50.06", "50.0601",
    "50.0602", "50.0605", "50.0607", "50.0699", "50.07", "50.0701",
    "50.0702", "50.0703", "50.0704", "50.0705", "50.0706", "50.0708",
    "50.0709", "50.071", "50.0711", "50.0712", "50.0713", "50.0799",
    "50.09", "50.0901", "50.0902", "50.0903", "50.0904", "50.0905",
    "50.0906", "50.0907", "50.0908", "50.0909", "50.091", "50.0911",
    "50.0912", "50.0913", "50.0914", "50.0915", "50.0916", "50.0999",
    "50.1", "50.1001", "50.1002", "50.1003", "50.1004", "50.1099",
    "50.99", "50.9999", "51", "51.0001", "51.01", "51.0101", "51.02",
    "51.0201", "51.0202", "51.0203", "51.0204", "51.0299", "51.04",
    "51.0401", "51.05", "51.0501", "51.0502", "51.0503", "51.0504",
    "51.0505", "51.0506", "51.0507", "51.0508", "51.0509", "51.051",
    "51.0511", "51.0599", "51.06", "51.0601", "51.0602", "51.0603",
    "51.0699", "51.07", "51.0701", "51.0702", "51.0703", "51.0704",
    "51.0705", "51.0706", "51.0707", "51.0708", "51.0709", "51.071",
    "51.0711", "51.0712", "51.0713", "51.0714", "51.0715", "51.0716",
    "51.0717", "51.0718", "51.0719", "51.0799", "51.08", "51.0801",
    "51.0802", "51.0803", "51.0805", "51.0806", "51.0808", "51.0809",
    "51.081", "51.0811", "51.0812", "51.0813", "51.0814", "51.0815",
    "51.0816", "51.0899", "51.09", "51.0901", "51.0902", "51.0903",
    "51.0904", "51.0905", "51.0906", "51.0907", "51.0908", "51.0909",
    "51.091", "51.0911", "51.0912", "51.0913", "51.0914", "51.0915",
    "51.0916", "51.0917", "51.0918", "51.0919", "51.092", "51.0999",
    "51.1", "51.1001", "51.1002", "51.1003", "51.1004", "51.1005",
    "51.1006", "51.1007", "51.1008", "51.1009", "51.101", "51.1011",
    "51.1012", "51.1099", "51.11", "51.1101", "51.1102", "51.1103",
    "51.1104", "51.1105", "51.1106", "51.1107", "51.1108", "51.1109",
    "51.1199", "51.12", "51.1201", "51.14", "51.1401", "51.15", "51.1501",
    "51.1502", "51.1503", "51.1504", "51.1505", "51.1506", "51.1507",
    "51.1508", "51.1509", "51.1599", "51.16", "51.1601", "51.1602",
    "51.1603", "51.1604", "51.1605", "51.1606", "51.1607", "51.1608",
    "51.1609", "51.161", "51.1611", "51.1612", "51.1613", "51.1614",
    "51.1616", "51.1617", "51.1618", "51.1699", "51.17", "51.1701",
    "51.18", "51.1801", "51.1802", "51.1803", "51.1804", "51.1899",
    "51.19", "51.1901", "51.2", "51.2001", "51.2002", "51.2003",
    "51.2004", "51.2005", "51.2006", "51.2007", "51.2008", "51.2009",
    "51.201", "51.2011", "51.2099", "51.21", "51.2101", "51.22",
    "51.2201", "51.2202", "51.2205", "51.2206", "51.2207", "51.2208",
    "51.2209", "51.221", "51.2211", "51.2212", "51.2299", "51.23",
    "51.2301", "51.2302", "51.2305", "51.2306", "51.2307", "51.2308",
    "51.2309", "51.231", "51.2311", "51.2312", "51.2313", "51.2314",
    "51.2399", "51.24", "51.2401", "51.25", "51.2501", "51.2502",
    "51.2503", "51.2504", "51.2505", "51.2506", "51.2507", "51.2508",
    "51.2509", "51.251", "51.2511", "51.2599", "51.26", "51.2601",
    "51.2602", "51.2603", "51.2604", "51.2699", "51.27", "51.2703",
    "51.2706", "51.2799", "51.31", "51.3101", "51.3102", "51.3103",
    "51.3104", "51.3199", "51.32", "51.3201", "51.33", "51.3301",
    "51.3302", "51.3303", "51.3304", "51.3305", "51.3306", "51.3399",
    "51.34", "51.3401", "51.3499", "51.35", "51.3501", "51.3502",
    "51.3503", "51.3599", "51.36", "51.3601", "51.3602", "51.3603",
    "51.3699", "51.37", "51.3701", "51.3702", "51.3703", "51.3704",
    "51.3799", "51.38", "51.3801", "51.3802", "51.3803", "51.3804",
    "51.3805", "51.3806", "51.3807", "51.3808", "51.3809", "51.381",
    "51.3811", "51.3812", "51.3813", "51.3814", "51.3815", "51.3816",
    "51.3817", "51.3818", "51.3819", "51.382", "51.3821", "51.3822",
    "51.3899", "51.39", "51.3901", "51.3902", "51.3999", "51.99",
    "51.9999", "52", "52.01", "52.0101", "52.02", "52.0201", "52.0202",
    "52.0203", "52.0204", "52.0205", "52.0206", "52.0207", "52.0208",
    "52.0209", "52.021", "52.0211", "52.0212", "52.0213", "52.0299",
    "52.03", "52.0301", "52.0302", "52.0303", "52.0304", "52.0305",
    "52.0399", "52.04", "52.0401", "52.0402", "52.0406", "52.0407",
    "52.0408", "52.0409", "52.041", "52.0411", "52.0499", "52.05",
    "52.0501", "52.06", "52.0601", "52.07", "52.0701", "52.0702",
    "52.0703", "52.0799", "52.08", "52.0801", "52.0803", "52.0804",
    "52.0806", "52.0807", "52.0808", "52.0809", "52.0899", "52.09",
    "52.0901", "52.0903", "52.0904", "52.0905", "52.0906", "52.0907",
    "52.0908", "52.0909", "52.0999", "52.1", "52.1001", "52.1002",
    "52.1003", "52.1004", "52.1005", "52.1099", "52.11", "52.1101",
    "52.12", "52.1201", "52.1206", "52.1207", "52.1299", "52.13",
    "52.1301", "52.1302", "52.1304", "52.1399", "52.14", "52.1401",
    "52.1402", "52.1403", "52.1499", "52.15", "52.1501", "52.16",
    "52.1601", "52.17", "52.1701", "52.18", "52.1801", "52.1802",
    "52.1803", "52.1804", "52.1899", "52.19", "52.1901", "52.1902",
    "52.1903", "52.1904", "52.1905", "52.1906", "52.1907", "52.1908",
    "52.1909", "52.191", "52.1999", "52.2", "52.2001", "52.21", "52.2101",
    "52.99", "52.9999", "53", "53.01", "53.0101", "53.0102", "53.0103",
    "53.0104", "53.0105", "53.0199", "53.02", "53.0201", "53.0202",
    "53.0203", "53.0299", "54", "54.01", "54.0101", "54.0102", "54.0103",
    "54.0104", "54.0105", "54.0106", "54.0107", "54.0108", "54.0199",
    "60", "60.01", "60.0101", "60.0102", "60.0103", "60.0104", "60.0105",
    "60.0106", "60.0107", "60.0108", "60.0109", "60.0199", "60.02",
    "60.0201", "60.0202", "60.0203", "60.0204", "60.0205", "60.0206",
    "60.0207", "60.0208", "60.0209", "60.021", "60.0211", "60.0212",
    "60.0213", "60.0214", "60.0215", "60.0216", "60.0217", "60.0218",
    "60.0219", "60.022", "60.0221", "60.0222", "60.0223", "60.0224",
    "60.0225", "60.0226", "60.0227", "60.0228", "60.0229", "60.023",
    "60.0231", "60.0232", "60.0233", "60.0234", "60.0235", "60.0236",
    "60.0237", "60.0238", "60.0239", "60.024", "60.0241", "60.0242",
    "60.0243", "60.0244", "60.0245", "60.0246", "60.0247", "60.0248",
    "60.0249", "60.025", "60.0251", "60.0252", "60.0253", "60.0254",
    "60.0255", "60.0256", "60.0257", "60.0258", "60.0259", "60.026",
    "60.0261", "60.0262", "60.0263", "60.0264", "60.0265", "60.0266",
    "60.0267", "60.0268", "60.0269", "60.027", "60.0271", "60.0299",
    "60.03", "60.0301", "60.0302", "60.0303", "60.0304", "60.0305",
    "60.0306", "60.0307", "60.0308", "60.0309", "60.031", "60.0311",
    "60.0312", "60.0313", "60.0314", "60.0315", "60.0316", "60.0317",
    "60.0318", "60.0319", "60.032", "60.0399", "60.04", "60.0401",
    "60.0402", "60.0403", "60.0404", "60.0405", "60.0406", "60.0407",
    "60.0408", "60.0409", "60.041", "60.0411", "60.0412", "60.0413",
    "60.0414", "60.0415", "60.0416", "60.0417", "60.0418", "60.0419",
    "60.042", "60.0421", "60.0422", "60.0423", "60.0424", "60.0425",
    "60.0426", "60.0427", "60.0428", "60.0429", "60.043", "60.0431",
    "60.0432", "60.0433", "60.0434", "60.0499", "60.05", "60.0501",
    "60.0502", "60.0503", "60.0504", "60.0505", "60.0506", "60.0507",
    "60.0508", "60.0509", "60.051", "60.0511", "60.0512", "60.0513",
    "60.0514", "60.0515", "60.0516", "60.0517", "60.0518", "60.0519",
    "60.052", "60.0521", "60.0522", "60.0523", "60.0524", "60.0525",
    "60.0526", "60.0527", "60.0528", "60.0529", "60.053", "60.0531",
    "60.0532", "60.0533", "60.0534", "60.0535", "60.0536", "60.0537",
    "60.0538", "60.0539", "60.054", "60.0541", "60.0542", "60.0543",
    "60.0544", "60.0545", "60.0546", "60.0547", "60.0548", "60.0549",
    "60.055", "60.0551", "60.0552", "60.0553", "60.0554", "60.0555",
    "60.0556", "60.0557", "60.0558", "60.0559", "60.056", "60.0561",
    "60.0562", "60.0563", "60.0564", "60.0565", "60.0566", "60.0567",
    "60.0568", "60.0569", "60.057", "60.0571", "60.0572", "60.0573",
    "60.0574", "60.0575", "60.0576", "60.0577", "60.0578", "60.0579",
    "60.058", "60.0581", "60.0582", "60.0583", "60.0584", "60.0599",
    "60.06", "60.0601", "60.0602", "9", "9.01", "9.0101", "9.0102",
    "9.0199", "9.04", "9.0401", "9.0402", "9.0404", "9.0499", "9.07",
    "9.0701", "9.0702", "9.0799", "9.09", "9.0901", "9.0902", "9.0903",
    "9.0904", "9.0905", "9.0906", "9.0907", "9.0908", "9.0999", "9.1",
    "9.1001", "9.99", "9.9999")


##CIP must be 2, 4 or 6 digits (not including decimals)
singles <- stringi::stri_pad_left(grep('^\\d{1,2}$', valid_cips, value=TRUE), 2, pad = '0')
singles_augmented <- unlist(lapply(c('', '.', '.00', '.0000'), function(x) paste0(singles, x)))

doubles <- grep('^\\d{1,2}\\.\\d{1,2}$', valid_cips, value=TRUE)
doubles <- gsub("(^\\d)(\\.)", "0\\1.", doubles, perl = TRUE)
doubles <- gsub("(\\.)(\\d$)", ".\\20", doubles, perl = TRUE)

doubles_augmented <- unlist(lapply(c('', '00'), function(x) paste0(doubles, x)))


triples <- grep('^\\d{1,2}\\.\\d{4}$', valid_cips, value=TRUE)
triples <- gsub("(^\\d)(\\.)", "0\\1.", triples, perl = TRUE)
triples <- gsub("(\\.)(\\d{3}$)", ".\\20", triples, perl = TRUE)


valid_cips_all <- sort(unique(c(singles_augmented, doubles_augmented, triples)))


